
import org.scalatest.FlatSpec
import fastparse.all._

class TestParser extends FlatSpec {

  "Test \"ab\"" should "be sucess" in {
    val ab = P("a" ~ "b")
    val Parsed.Success(v, index) = ab.parse("ab")
    assert(v == (), index == 2)
    val Parsed.Failure(parser, 1, _) = ab.parse("aa")
    assert(parser == ("b": P0))
  }
  "Test repeat" should "be sucess" in {
    val ab = P("a".rep ~ "b")
    val Parsed.Success(_, idx) = ab.parse("aaaaaaab")
    assert(idx == 8)
    val Parsed.Success(parser, idx2) = ab.parse("aaaba")
    assert(parser == ("a": P0))
  }
}
